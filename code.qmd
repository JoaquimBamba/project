---
title: "quarto"
author: "Amandine & Joaquim"
format: html
echo: false
message: false
editor: visual
---

# Data management project :

Joaquim Bamba & Amandine Godefroy

## Links and sources

[Link github repository](https://github.com/JoaquimBamba/project)

*Links to the sources :*

[CO2 emission](https://www.cia.gov/the-world-factbook/field/carbon-dioxide-emissions/country-comparison/)

[Energy consumption](https://www.cia.gov/the-world-factbook/field/energy-consumption-per-capita/country-comparison/)

[GDP growth](https://data.worldbank.org/indicator/NY.GDP.MKTP.KD.ZG)

[GDP](https://data.worldbank.org/indicator/NY.GDP.MKTP.CD)

[GDP composition by sector of origin](https://wdi.worldbank.org/table/4.2)

[Gross capital formation](https://data.worldbank.org/indicator/NE.GDI.TOTL.ZS?view=chart)

[Population growth](https://data.worldbank.org/indicator/SP.POP.GROW?view=chart)

[Urban population](https://data.worldbank.org/indicator/SP.URB.TOTL.IN.ZS?view=chart)

[Industrial production growth](https://data.worldbank.org/indicator/SP.URB.TOTL.IN.ZS?view=chart)

[Renewable energy consumption](https://data.worldbank.org/indicator/EG.FEC.RNEW.ZS)

*Sources* *:*

-   **CIA.gov :** The CIA's "World Factbook" is a comprehensive and publicly available online resource that provides information about countries around the world. Created and maintained by the United States Central Intelligence Agency (CIA), this publication offers a detailed overview of various aspects of nations, including their geography, population, government, economy, infrastructure, history, and much more. The World Factbook is regularly updated to reflect demographic, political, economic, and other changes in countries worldwide. It's used by numerous individuals, including researchers, students, journalists, and professionals, as a reliable reference for obtaining accurate data about countries.

-   **World Bank Open Data :** The World Bank Open Data is an initiative by the World Bank Group that provides free and open access to a wide range of global development data. It offers a vast collection of data on various aspects of development across countries, including social, economic, financial, and environmental indicators. This data is made available to the public, researchers, policymakers, and developers to promote transparency, informed decision-making, and development efforts worldwide. The World Bank Open Data platform allows users to access, download, and visualize data in various formats, including charts, graphs, and maps. It serves as a valuable resource for researchers, policymakers, journalists, and anyone interested in understanding global development trends and making data-driven decisions to support development initiatives worldwide.

## Data importation

```{r}
#| echo: false
#| warning: false

library(here)
library(ggplot2)
library(tidyr)
library(dplyr)
here::i_am("project.Rproj")
```

```{r}

#| echo: false
#| warning: false

GDP <- read.csv2(here("data/GDP.csv"))

gdp_growth <- read.csv2(here("data/GDP_growth.csv"))

gdp_by_sector <- read.csv2(here("data/Structure_of_value_added.csv"))

co2 <- vroom::vroom(here("data/CO2.csv"), show_col_types = FALSE)

energy_consumption <- vroom::vroom(here("data/Energy_consumption.csv"),show_col_types = FALSE)

gross_capital <- read.csv2(here("data/Gross_capital_formation.csv"))

population_growth <- read.csv2(here("data/POP_growth.csv"))

urban_population <- read.csv2(here("data/Urban_population.csv"))
co2 <- vroom::vroom(here("data/CO2.csv"), show_col_types = FALSE)

coal_revenu <- vroom::vroom(here("data/coal_revenu.csv"), show_col_types = FALSE)

industrial_production_growth <- vroom::vroom(here("data/industrial_production_growth.csv"), show_col_types = FALSE)

renewable_energy_consumption <- vroom::vroom(here("data/Renewable_energy_consumption.csv"), show_col_types = FALSE)
```

## Creation of the economic growth database

### Variables description

Gross capital formation (in percentage of GDP) : consists of outlays on additions to the fixed assets of the economy plus net changes in the level of inventories.

Annual percentage growth rate of GDP : at market prices based on constant local currency. Aggregates are based on constant 2015 prices, expressed in U.S. dollars.

GDP at purchaser's prices (current US\$) : the sum of gross value added by all resident producers in the economy plus any product taxes and minus any subsidies not included in the value of the products.

The structure of value added : the percentage of GDP coming from Agriculture, Industry, Manufacturing and Services.

Annual population growth rate for year t : the exponential rate of growth of midyear population from year t-1 to t, expressed as a percentage .

Urban population (in percentage of the total population) : refers to people living in urban areas as defined by national statistical offices.

### Cleaning the data sets

We will only keep the values for the year 2019 in our study when we have the choice of the year.

#### cleaning of gross_capital

```{r}
# We keep only the necessary columns
gross_capital <- gross_capital |>
  select(Country.Name, X2019) |>
  rename(country = Country.Name, gross.capital = X2019) 

# We put NA instead of blanks
gross_capital <- gross_capital %>% mutate_all(~na_if(., ""))

# Then we re-iterate the process for each variable.
```

#### cleaning of gdp_growth

```{r}
gdp_growth <- gdp_growth |> select(Country.Name, X2019) |> rename(country = Country.Name, gdp.growth = X2019)

gdp_growth[gdp_growth == ''] <- NA
```

#### cleaning of GDP

```{r}
GDP <- GDP |>  select(Country.Name, X2019) |> rename(country = Country.Name, gdp = X2019)

GDP <- GDP %>% mutate_all(~na_if(., ""))
```

#### cleaning of gdp_by_sector

```{r}
gdp_by_sector <- gdp_by_sector |> select(X, X.5, X.4, X.3, X.2) |>
  rename(gdp.agriculture = X.2,
         gdp.industry = X.3,
         gdp.manufacturing = X.4,
         gdp.services = X.5,
         country = X)

# We suppress the unnecessary rows
gdp_by_sector <- gdp_by_sector[-1,]
gdp_by_sector <- gdp_by_sector[-1,]

gdp_by_sector <- gdp_by_sector %>% mutate_all(~na_if(., ".."))
```

#### cleaning of population_growth

```{r}
population_growth <- population_growth |>  select(Country.Name, X2019) |> rename(country = Country.Name, population.growth = X2019)

population_growth[population_growth == ''] <- NA
```

#### cleaning of urban_population

```{r}
urban_population <- urban_population |>  select(Country.Name, X2019) |> rename(country = Country.Name, urban.population = X2019)

urban_population <- urban_population %>% mutate_all(~na_if(., ""))
```

### Basic information on the data files

#### GDP

```{r}
table_gdp <- GDP |>
  summarise(
            "Nb of rows" =nrow(GDP),
            "Nb of columns" = ncol(GDP),
            "Mean" = mean(as.numeric(gdp), na.rm = TRUE),
            "Median" = median(gdp, na.rm = TRUE),
            "Min" = min(gdp, na.rm = TRUE),
            "Max" = max(gdp, na.rm = TRUE)
            )
knitr::kable(table_gdp)
```

#### gdp_growth

```{r}
table_gdp_growth <- gdp_growth|>
  summarise(
            "Nb of rows"=nrow(gdp_growth),
            "Nb of columns"=ncol(gdp_growth),
            "Mean" = mean(as.numeric(gdp.growth), na.rm = TRUE),
            "Median" = median(as.numeric(gdp.growth), na.rm = TRUE),
            "Min" = min(gdp.growth, na.rm = TRUE),
            "Max" = max(gdp.growth, na.rm = TRUE)
            )
knitr::kable(table_gdp_growth)
```

#### gross_capital

```{r}
table_gross_capital <- gross_capital|>
  summarise(
            "Nb of rows"=nrow(gross_capital),
            "Nb of columns"=ncol(gross_capital),
            "Mean" = mean(as.numeric(gross.capital), na.rm = TRUE),
            "Median" = median(gross.capital, na.rm = TRUE),
            "Min" = min(gross.capital, na.rm = TRUE),
            "Max" = max(gross.capital, na.rm = TRUE)
            )
knitr::kable(table_gross_capital)
```

#### gdp_by_sector

```{r}
table_gdp_by_sector <- gdp_by_sector |>
  summarise(
    "Nb of rows" = nrow(gdp_by_sector),
    "Nb of columns" = ncol(gdp_by_sector),
    "Mean.services" = mean(as.numeric(gdp.services), na.rm = TRUE),
    "Median.services" = median(as.numeric(gdp.services), na.rm = TRUE),
    "Mean.manufacturing" = mean(as.numeric(gdp.manufacturing), na.rm = TRUE),
    "Median.manufacturing" = median(as.numeric(gdp.manufacturing), na.rm = TRUE),
    "Mean.industry" = mean(as.numeric(gdp.industry), na.rm = TRUE),
    "Median.industry" = median(as.numeric(gdp.industry), na.rm = TRUE),
    "Mean.agriculture" = mean(as.numeric(gdp.agriculture), na.rm = TRUE),
    "Median.agriculture" = median(as.numeric(gdp.agriculture), na.rm = TRUE)
  )
knitr::kable(table_gdp_by_sector)
```

#### population_growth

```{r}
table_population_growth <- population_growth |>
  summarise(
    "Nb of rows" = nrow(population_growth),
    "Nb of columns" = ncol(population_growth),
    "Mean" = mean(as.numeric(population.growth), na.rm = TRUE),
    "Median" = median(population.growth, na.rm = TRUE),
    "Min" = min(population.growth, na.rm = TRUE),
    "Max" = max(population.growth, na.rm = TRUE)
  )
knitr::kable(table_population_growth)
```

#### urban_population

```{r}
table_urban_population <- urban_population |>
  summarise(
    "Nb of rows" = nrow(urban_population),
    "Nb of columns" = ncol(urban_population),
    "Mean" = mean(as.numeric(urban.population), na.rm = TRUE),
    "Median" = median(urban.population, na.rm = TRUE),
    "Min" = min(urban.population, na.rm = TRUE),
    "Max" = max(urban.population, na.rm = TRUE)
  )
knitr::kable(table_urban_population)
```

### Data joining

We need to create a data base with all the economic growth relative variables.

```{r}
# In order to do so we join each of the data base two by two
gdp_gdp_growth <- inner_join(GDP, gdp_growth, by=join_by(country))

all_gdp <- inner_join(gdp_gdp_growth, gdp_by_sector, by=join_by(country))

all_gdp_gross_capital <- inner_join(all_gdp, gross_capital, by=join_by(country))

pop_growth_urban_pop <- inner_join(population_growth, urban_population, by=join_by(country))

# Final economic growth data base
economic_growth_dataset <- inner_join(all_gdp_gross_capital, pop_growth_urban_pop, by=join_by(country))
```

## Creation of the energy database

### Variables description

CO2 emissions : Carbon dioxide emissions from consumption of energy is the total amount of carbon dioxide, measured in metric tons, released by burning fossil fuels in the process of producing and consuming energy. This is usually the main variable used to measure how polluting a country is.

Energy consumption per capita : measures the total amount of consumed energy divided by a country's population, reported in Btu per person. Linking energy consumption per capita to pollution is vital as higher consumption often translates to increased emissions from energy sources like fossil fuels, contributing significantly to air and greenhouse gas pollution.

Coal revenu : revenu from coal extraction and use as % of the GDP. Coal has a significant environmental impact as a high emitter of pollutants like sulfur dioxide and carbon dioxide when burned for energy.

Industrial_production_growth : annual percentage increase in industrial production (includes manufacturing, mining, and construction). The expansion of industrial activities often leads to increased emissions of pollutants, including greenhouse gases and particulate matter, directly impacting air, water, and soil quality.

Renewable energy consumption : Renewable energy consumption is the share of renewable energy in total final energy consumption. We expect this percentage to be higher in developed countries.

### Cleaning the data sets

```{r}
# We keep only the relevant columns
co2 <- select(co2, value, name)

energy_consumption <- select(energy_consumption, value, name)

coal_revenu <- select(coal_revenu, value, name)

industrial_production_growth <- select(industrial_production_growth, value, name)

renewable_energy_consumption <- select(renewable_energy_consumption, `Country Name`, `2019`)

# We rename them
colnames(co2) <- c("co2.emissions", "country")
colnames(energy_consumption) <- c("energy.consumption", "country")
colnames(coal_revenu) <- c("coal.revenu", "country")
colnames(industrial_production_growth) <- c("industrial.production.growth", "country")
colnames(renewable_energy_consumption) <- c("country", "renewable.energy.consumption")
```

### Basic information on the data files

#### co2

```{r}
table_co2 <- co2 |>
  summarise(
    "Nb of rows" = nrow(co2),
    "Nb of columns" = ncol(co2),
    "Mean" = mean(co2.emissions, na.rm = TRUE),
    "Median" = median(co2.emissions, na.rm = TRUE),
    "Min" = min(co2.emissions, na.rm = TRUE),
    "Max" = max(co2.emissions, na.rm = TRUE)
  )
knitr::kable(table_co2)
```

#### energy_consumption

```{r}
table_energy_consumption <- energy_consumption |>
  summarise(
    "Nb of rows" = nrow(energy_consumption),
    "Nb of columns" = ncol(energy_consumption),
    "Mean" = mean(energy.consumption, na.rm = TRUE),
    "Median" = median(energy.consumption, na.rm = TRUE),
    "Min" = min(energy.consumption, na.rm = TRUE),
    "Max" = max(energy.consumption, na.rm = TRUE)
  )
knitr::kable(table_energy_consumption)
```

#### coal_revenu

```{r}
table_coal_revenu <- coal_revenu |>
  summarise(
    "Nb of rows" = nrow(coal_revenu),
    "Nb of columns" = ncol(coal_revenu),
    "Mean" = mean(coal.revenu, na.rm = TRUE),
    "Median" = median(coal.revenu, na.rm = TRUE),
    "Min" = min(coal.revenu, na.rm = TRUE),
    "Max" = max(coal.revenu, na.rm = TRUE)
  )
knitr::kable(table_coal_revenu)
```

#### industrial_production_growth

```{r}
table_industrial_production_growth <- industrial_production_growth |>
  summarise(
    "Nb of rows" = nrow(industrial_production_growth),
    "Nb of columns" = ncol(industrial_production_growth),
    "Mean" = mean(industrial.production.growth, na.rm = TRUE),
    "Median" = median(industrial.production.growth, na.rm = TRUE),
    "Min" = min(industrial.production.growth, na.rm = TRUE),
    "Max" = max(industrial.production.growth, na.rm = TRUE)
  )
knitr::kable(table_industrial_production_growth)
```

#### renewable_energy_consumption

```{r}
table_renewable_energy_consumption <- renewable_energy_consumption |>
  summarise(
    "Nb of rows" = nrow(renewable_energy_consumption),
    "Nb of columns" = ncol(renewable_energy_consumption),
    "Mean" = mean(renewable.energy.consumption, na.rm = TRUE),
    "Median" = median(renewable.energy.consumption, na.rm = TRUE),
    "Min" = min(renewable.energy.consumption, na.rm = TRUE),
    "Max" = max(renewable.energy.consumption, na.rm = TRUE)
  )
knitr::kable(table_renewable_energy_consumption)
```

### Data joining

```{r}
# we merge the data sets by country name
temp_merged <- merge(co2, energy_consumption, by = "country", all = FALSE)
temp_merged <- merge(temp_merged, industrial_production_growth, by = "country", all = FALSE)
temp_merged <- merge(temp_merged, coal_revenu, by = "country", all = FALSE)
# we merge the temporary data set obtained with the last one with name again
energy_dataset <- merge(temp_merged, renewable_energy_consumption, by = "country", all = FALSE)

```

## Final Data set

```{r}
# We merge our economic growth dataset and our energy dataset 

dataset <- inner_join(economic_growth_dataset, energy_dataset, by=join_by(country))
```

## Research question

The Environmental Kuznets Curve (EKC) suggests that environmental degradation initially worsens as a country begins industrialization and economic development. In the early stages of economic growth, the increased production and consumption often lead to higher pollution levels, resource depletion, and environmental damage. This phase is characterized by rising pollution levels, as industries prioritize economic growth over environmental concerns. However, according to the EKC hypothesis, as a country's income or level of development continues to increase, there reaches a turning point where environmental degradation begins to decrease.

We will try to see if a country CO2 emission are effectively explained by its economic and industrial development.

## Graphical representation of the main target variable

We will make a graphical representation of our target variable : CO2 emissions.

```{r}
# Third countries with the highest CO2 emissions ?
top_countries <- dataset[order(-dataset$co2.emissions), ][1:3, ]


# Creation of the graph with the points of the most polluters
ggplot(data = dataset, aes(x = country, y = co2.emissions)) +
  geom_blank() +  # Suppression of the points to mask the name of the other countries on the x axis
  geom_text(data = top_countries, aes(label = country), size = 3, angle = 45, vjust = -0.5, hjust = 1) +  # Display of the names of the greatest polluters
  geom_point(data = top_countries, size = 3) +  # Points for the three greatest polluters
  labs(x = NULL, y = "Émissions de CO2 en 2019") +  # Suppression of the x axis label 
  ggtitle("Dispersions des émissions de CO2 par pays en 2019")

```

We can spot that CO2 emissions are very unequally distributed. China, India and the US are by far more polluting.
